<!doctype html>
<html>

<head>
    <script src="asyncReq.js">


    </script>
    <script>
        var oldTemp;
        var oldHumin;
        var oldLight;
        var runCount;

        var x = function() {
            loadFile("./getData", function(data) {
                var obj = JSON.parse(data);
                if (runCount == 0) {
                    document.getElementById("results").innerHTML =
                        "<b>LIGHT:</b><br> " + obj.light +
                        "<br> <b>TEMP:</b><br> " + obj.temp + "F" +
                        "<br> <b>HUMIDITY:</b><br> " + obj.humidity + "%";
                    runCount++;
                } else {
                    document.getElementById("results").innerHTML = "";
                    if (oldLight > obj.light) {
                        document.getElementById("results").innerHTML +=
                            "<p style='color:green;'><b>LIGHT</b><br>" + obj.light + " (-" + (oldLight - obj.light) + ")<br></p>";
                    } else if (oldLight < obj.light) {
                        document.getElementById("results").innerHTML +=
                            "<p style='color:red;'><b>LIGHT</b><br>" + obj.light + " (+" + (obj.light - oldLight) + ")<br></p>";
                    } else {
                        document.getElementById("results").innerHTML +=
                            "<b>LIGHT</b><br>" + obj.light + " (--)<br>";
                    }
                    
                    if (oldTemp > obj.temp) {
                        document.getElementById("results").innerHTML +=
                            "<p style='color:green;'><b>TEMP</b><br>" + obj.temp + "F (-" + (oldTemp - obj.temp) + ")<br></p>";
                    } else if (oldTemp < obj.temp) {
                        document.getElementById("results").innerHTML +=
                            "<p style='color:red;'><b>TEMP</b><br>" + obj.light + "F (+" + (obj.temp - oldTemp) + ")<br></p>";
                    } else {
                        document.getElementById("results").innerHTML +=
                            "<b>TEMP</b><br>" + obj.temp + "F (--)<br>";
                    }
                    
                    if (oldHumin > obj.humidity) {
                        document.getElementById("results").innerHTML +=
                            "<p style='color:green;'><b>HUMIDITY</b><br>" + obj.humidity + "% (-" + (oldHumin - obj.humidity) + ")<br></p>";
                    } else if (oldLight < obj.light) {
                        document.getElementById("results").innerHTML +=
                            "<p style='color:red;'><b>HUMIDITY</b><br>" + obj.humidity + "% (+" + (obj.humidity - oldHumin) + ")<br></p>";
                    } else {
                        document.getElementById("results").innerHTML +=
                            "<b>HUMIDITY</b><br>" + obj.humidity + "% (--)<br>";
                    }
                }

                oldTemp = obj.temp;
                oldHumin = obj.humidity;
                oldLight = obj.light;
            });
        }

        function start() {
            runCount = 0;
            x();
            setInterval("x()", 1000);
        }

    </script>

</head>

<body onload='start()'>
    <h1> TEST </h1>

    <div id='results'> </div>

</body>

</html>
