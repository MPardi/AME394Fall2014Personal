<!doctype html>
<html>

<head>
    <script src="asyncReq.js">


    </script>
    <script>
        var oldTemp;
        var oldHumin;
        var oldLight;
        var runCount;

        var x = function() {
            loadFile("./getData", function(data) {
                var obj = JSON.parse(data);
                if (runCount == 0) {
                    document.getElementById("results").innerHTML =
                        "<h2><b>LIGHT:</b></h2><p>" + obj.light + "</p>" +
                        "<h2><b>TEMP:</b></h2><p>" + obj.temp + "F" + "</p>" +
                        "<h2><b>HUMIDITY:</b></h2><p>" + obj.humidity + "%</p>";
                    runCount++;
                } else {
                    document.getElementById("results").innerHTML = "";
                    if (oldLight > obj.light) {
                        document.getElementById("results").innerHTML +=
                            "<h2><b>LIGHT</b></h2><p style='color:green;'>" + obj.light + " (-" + (oldLight - obj.light) + ")<br></p>";
                    } else if (oldLight < obj.light) {
                        document.getElementById("results").innerHTML +=
                            "<h2><b>LIGHT</b></h2><p style='color:red;'>" + obj.light + " (+" + (obj.light - oldLight) + ")<br></p>";
                    } else {
                        document.getElementById("results").innerHTML +=
                            "<h2><b>LIGHT</b></h2><p>" + obj.light + " (--)<br></p>";
                    }
                    
                    if (oldTemp > obj.temp) {
                        document.getElementById("results").innerHTML +=
                            "<h2><b>TEMP</b></h2><p style='color:green;'>" + obj.temp + "F (-" + (oldTemp - obj.temp) + ")<br></p>";
                    } else if (oldTemp < obj.temp) {
                        document.getElementById("results").innerHTML +=
                            "<h2><b>TEMP</b></h2><p style='color:green;'>" + obj.light + "F (+" + (obj.temp - oldTemp) + ")<br></p>";
                    } else {
                        document.getElementById("results").innerHTML +=
                            "<h2><b>TEMP</b></h2><p style='color:green;'>" + obj.temp + "F (--)<br><p>";
                    }
                    
                    if (oldHumin > obj.humidity) {
                        document.getElementById("results").innerHTML +=
                            "<h2><b>HUMIDITY</b></h2><p style='color:green;'>" + obj.humidity + "% (-" + (oldHumin - obj.humidity) + ")<br></p>";
                    } else if (oldLight < obj.light) {
                        document.getElementById("results").innerHTML +=
                            "<h2><b>HUMIDITY</b></h2><p style='color:green;'>" + obj.humidity + "% (+" + (obj.humidity - oldHumin) + ")<br></p>";
                    } else {
                        document.getElementById("results").innerHTML +=
                            "<h2><b>HUMIDITY</b></h2><p style='color:green;'>" + obj.humidity + "% (--)<br></p>";
                    }
                }

                oldTemp = obj.temp;
                oldHumin = obj.humidity;
                oldLight = obj.light;
            });
        }

        function start() {
            runCount = 0;
            x();
            setInterval("x()", 1000);
        }

    </script>

</head>

<body onload='start()'>
    <h1 style="text-align: center;">IoT SENSOR DATA</h1>
    <hr>
    <div style="text-align: center;" id='results'> </div>

</body>

</html>
